(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{jkDv:function(e,t,n){"use strict";n.r(t),n.d(t,"AdminModule",(function(){return k}));var s=n("ofXK"),i=n("fXoL");let r=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Eb({type:e,selectors:[["app-admin-sessions"]],decls:2,vars:0,template:function(e,t){1&e&&(i.Pb(0,"p"),i.wc(1,"admin-sessions works!"),i.Ob())},styles:[""]}),e})();var o=n("AytR"),a=n("tyNb"),c=n("GXvH"),d=n("l3fW"),b=n("1kSV");function u(e,t){if(1&e){const e=i.Qb();i.Pb(0,"ngb-alert",12),i.ac("close",(function(){return i.nc(e),i.cc(2).ShowMessage=!1})),i.wc(1),i.Ob()}if(2&e){const e=i.cc(2);i.fc("type",e.MessageType),i.xb(1),i.yc(" ",e.ResponseFromBackend.Error.Message,"")}}function l(e,t){if(1&e){const e=i.Qb();i.Pb(0,"li",13),i.ac("click",(function(){i.nc(e);const n=t.$implicit;return i.cc(2).AdminServ.SelectItemUsersList(n)})),i.Pb(1,"div",14),i.Pb(2,"p",15),i.wc(3),i.Ob(),i.Pb(4,"div",16),i.Pb(5,"button",17),i.wc(6,"Edit"),i.Ob(),i.Pb(7,"button",18),i.ac("click",(function(){i.nc(e);const n=t.$implicit,s=t.index;return i.cc(2).OnDeleteUser(n,s)})),i.wc(8,"Delete"),i.Ob(),i.Ob(),i.Ob(),i.Ob()}if(2&e){const e=t.$implicit,n=t.index,s=i.cc(2);i.fc("ngClass",s.AdminServ.IsCurrentSelected(e)?"active":""),i.xb(3),i.yc(" ",e.Email,""),i.xb(2),i.fc("routerLink",n)}}function p(e,t){if(1&e){const e=i.Qb();i.Pb(0,"ngb-pagination",19),i.ac("pageChange",(function(t){return i.nc(e),i.cc(2).OnPageChanged(t)})),i.Ob()}if(2&e){const e=i.cc(2);i.fc("collectionSize",e.usCollectionSize)("pageSize",e.usPageSize)("page",e.usCurrentPage)("rotate",!0)("boundaryLinks",!0)("maxSize",11)}}const g=function(e){return["/admin",e,"new"]};function h(e,t){if(1&e&&(i.Pb(0,"div",3),i.Pb(1,"div",4),i.Pb(2,"div",5),i.Pb(3,"div",6),i.Pb(4,"button",7),i.wc(5,"Add"),i.Ob(),i.Ob(),i.Ob(),i.uc(6,u,2,2,"ngb-alert",8),i.Pb(7,"ul",9),i.uc(8,l,9,3,"li",10),i.Ob(),i.uc(9,p,1,6,"ngb-pagination",11),i.Ob(),i.Ob()),2&e){const e=i.cc();i.xb(4),i.fc("routerLink",i.ic(4,g,e.usCurrentPage)),i.xb(2),i.fc("ngIf",e.ShowMessage),i.xb(2),i.fc("ngForOf",e.Users),i.xb(1),i.fc("ngIf",e.usCollectionSize>e.usPageSize)}}function m(e,t){1&e&&(i.Pb(0,"div",20),i.Pb(1,"span",21),i.wc(2,"Loading..."),i.Ob(),i.Ob())}let f=(()=>{class e{constructor(e,t,n,s){this.ActiveRoute=e,this.DataServ=t,this.AdminServ=n,this.router=s}ngOnDestroy(){this.RecivedErrorSub.unsubscribe(),this.PageChanged.unsubscribe(),this.DataLoading.unsubscribe(),this.FetchOnInint.unsubscribe()}ngOnInit(){this.usPageSize=o.a.AdminUserListPageSize,this.RecivedErrorSub=this.DataServ.RecivedError.subscribe(e=>{switch(this.ShowMessage=!0,this.ResponseFromBackend=e,setTimeout(()=>this.ShowMessage=!1,5e3),e.Error.Code){case 200:this.MessageType="success";break;default:this.MessageType="danger"}}),this.PageChanged=this.ActiveRoute.params.subscribe(e=>{this.usCurrentPage=+e.pn}),this.DataLoading=this.DataServ.LoadingData.subscribe(e=>{this.IsLoading=e}),this.FetchOnInint=this.DataServ.FetchUsersList(this.usCurrentPage,o.a.AdminUserListPageSize).subscribe(e=>{this.Users=this.AdminServ.GetUsers(),this.usCollectionSize=this.AdminServ.Total},e=>{this.Users=[]})}OnPageChanged(e){this.usCurrentPage=e,this.FetchOnInint=this.DataServ.FetchUsersList(e,o.a.AdminUserListPageSize).subscribe(()=>{this.Users=this.AdminServ.GetUsers(),this.router.navigate(["../",e.toString()],{relativeTo:this.ActiveRoute})})}OnDeleteUser(e,t){this.AdminServ.DeleteUser(t),this.DataServ.DeleteUser(e),this.Users=this.AdminServ.GetUsers()}}return e.\u0275fac=function(t){return new(t||e)(i.Kb(a.a),i.Kb(c.a),i.Kb(d.a),i.Kb(a.c))},e.\u0275cmp=i.Eb({type:e,selectors:[["app-admin-list"]],decls:3,vars:2,consts:[["class","row",4,"ngIf"],[1,"text-center"],["class","spinner-border","role","status",4,"ngIf"],[1,"row"],[1,"col"],[1,"input-group","mb-1"],[1,"input-group-prepend","mt-1"],["queryParamsHandling","merge",1,"btn","btn-outline-primary",3,"routerLink"],[3,"type","close",4,"ngIf"],[1,"list-group","mb-1"],["style","cursor: pointer;","class","list-group-item list-group-item-action d-flex justify-content-between align-items-center",3,"ngClass","click",4,"ngFor","ngForOf"],[3,"collectionSize","pageSize","page","rotate","boundaryLinks","maxSize","pageChange",4,"ngIf"],[3,"type","close"],[1,"list-group-item","list-group-item-action","d-flex","justify-content-between","align-items-center",2,"cursor","pointer",3,"ngClass","click"],[1,"input-group"],[1,"p-2","m-0","flex-grow-1",2,"place-items","center"],[1,"input-group-append"],["type","button",1,"btn","btn-outline-success",3,"routerLink"],["type","button",1,"btn","btn-outline-danger",3,"click"],[3,"collectionSize","pageSize","page","rotate","boundaryLinks","maxSize","pageChange"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(e,t){1&e&&(i.uc(0,h,10,6,"div",0),i.Pb(1,"div",1),i.uc(2,m,3,0,"div",2),i.Ob()),2&e&&(i.fc("ngIf",!t.IsLoading),i.xb(2),i.fc("ngIf",t.IsLoading))},directives:[s.k,a.d,s.j,b.a,s.i,b.i],styles:[""]}),e})(),v=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Eb({type:e,selectors:[["app-admin-media"]],decls:2,vars:0,template:function(e,t){1&e&&(i.Pb(0,"p"),i.wc(1,"admin-media works!"),i.Ob())},styles:[""]}),e})(),w=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Eb({type:e,selectors:[["app-admin"]],decls:9,vars:0,consts:[[1,"ml-1"]],template:function(e,t){1&e&&(i.Pb(0,"h2",0),i.wc(1,"Sessions"),i.Ob(),i.Lb(2,"app-admin-sessions"),i.Pb(3,"h2",0),i.wc(4,"Users"),i.Ob(),i.Lb(5,"app-admin-list"),i.Pb(6,"h2",0),i.wc(7,"Media"),i.Ob(),i.Lb(8,"app-admin-media"))},directives:[r,f,v],styles:[""]}),e})();var P=n("dxYa"),O=n("3Pt+"),S=n("Y93L");function x(e,t){1&e&&(i.Pb(0,"div",4),i.Pb(1,"span",5),i.wc(2,"Loading..."),i.Ob(),i.Ob())}function y(e,t){if(1&e){const e=i.Qb();i.Pb(0,"ngb-alert",6),i.ac("close",(function(){return i.nc(e),i.cc().ShowMessage=!1})),i.wc(1),i.Ob()}if(2&e){const e=i.cc();i.fc("type",e.MessageType),i.xb(1),i.yc(" ",e.ResponseFromBackend.Error.Message,"")}}function U(e,t){1&e&&(i.Pb(0,"h2"),i.wc(1,"Edit"),i.Ob())}function M(e,t){1&e&&(i.Pb(0,"h2"),i.wc(1,"Create"),i.Ob())}function C(e,t){if(1&e){const e=i.Qb();i.Pb(0,"form",7,8),i.ac("ngSubmit",(function(){i.nc(e);const t=i.mc(1);return i.cc().OnSaveClick(t)})),i.Pb(2,"div",9),i.Pb(3,"div",10),i.uc(4,U,2,0,"h2",11),i.uc(5,M,2,0,"h2",11),i.Pb(6,"div",9),i.Pb(7,"label",12),i.wc(8,"Name"),i.Ob(),i.Lb(9,"input",13),i.Ob(),i.Pb(10,"div",9),i.Pb(11,"label",14),i.wc(12,"Email"),i.Ob(),i.Lb(13,"input",15),i.Ob(),i.Pb(14,"div",9),i.Pb(15,"label",16),i.wc(16,"Phone"),i.Ob(),i.Lb(17,"input",17),i.Ob(),i.Pb(18,"div",9),i.Pb(19,"label",18),i.wc(20,"Select role:"),i.Ob(),i.Pb(21,"select",19),i.Pb(22,"option",20),i.wc(23,"Guest"),i.Ob(),i.Pb(24,"option",21),i.wc(25,"Admin"),i.Ob(),i.Ob(),i.Ob(),i.Pb(26,"label",22),i.wc(27,"Password"),i.Ob(),i.Pb(28,"div",23),i.Pb(29,"div",24),i.Pb(30,"div",25),i.Pb(31,"input",26),i.ac("ngModelChange",(function(t){return i.nc(e),i.cc().changepassword=t})),i.Ob(),i.Ob(),i.Ob(),i.Lb(32,"input",27),i.Ob(),i.Pb(33,"button",28),i.wc(34,"Save"),i.Ob(),i.Pb(35,"button",29),i.wc(36,"Cancel"),i.Ob(),i.Ob(),i.Ob(),i.Ob()}if(2&e){const e=i.mc(1),t=i.cc();i.xb(4),i.fc("ngIf",t.editmode),i.xb(1),i.fc("ngIf",!t.editmode),i.xb(4),i.fc("ngModel",t.UserToEdit.Name),i.xb(4),i.fc("ngModel",t.UserToEdit.Email),i.xb(4),i.fc("ngModel",t.UserToEdit.Phone),i.xb(4),i.fc("ngModel",t.UserToEdit.Role),i.xb(10),i.fc("ngModel",t.changepassword),i.xb(1),i.fc("disabled",!t.changepassword),i.xb(1),i.fc("disabled",e.invalid)}}let E=(()=>{class e{constructor(e,t,n,s){this.AdminServ=e,this.activatedroute=t,this.router=n,this.datastore=s}ngOnDestroy(){this.DataLoading.unsubscribe(),this.RecivedErrorSub.unsubscribe(),this.DatabaseUpdated&&this.DatabaseUpdated.unsubscribe()}ngOnInit(){this.activatedroute.params.subscribe(e=>{this.editmode=null!=e.id,this.editmode?(this.index=+e.id,this.UserToEdit=this.AdminServ.GetUserById(this.index)):(this.changepassword=!0,this.UserToEdit=new S.a("guest_role_read_only","","","")),this.AdminServ.CurrentSelectedItem=this.UserToEdit}),this.RecivedErrorSub=this.datastore.RecivedError.subscribe(e=>{switch(this.ShowMessage=!0,this.ResponseFromBackend=e,setTimeout(()=>this.ShowMessage=!1,5e3),e.Error.Code){case 200:this.MessageType="success";break;default:this.MessageType="danger"}}),this.DataLoading=this.datastore.LoadingData.subscribe(e=>{this.IsLoading=e})}OnSaveClick(e){if(e.valid){if(e.value.changepassword&&0===e.value.newpassword.length)return;this.UserToEdit.Email=e.value.useremail,this.UserToEdit.Name=e.value.username,this.UserToEdit.Phone=e.value.userphone,this.UserToEdit.Role=e.value.roles,this.datastore.SaveUser(this.UserToEdit,e.value.changepassword,e.value.newpassword),this.DatabaseUpdated=this.datastore.UserUpdateInsert.subscribe(e=>{this.editmode?(this.UserToEdit=e,this.AdminServ.UpdateExistingUser(this.UserToEdit,this.index)):(this.UserToEdit=e,this.AdminServ.AddNewUser(this.UserToEdit)),setTimeout(()=>this.router.navigate(["../"],{relativeTo:this.activatedroute,queryParamsHandling:"merge"}),1e3)})}}}return e.\u0275fac=function(t){return new(t||e)(i.Kb(d.a),i.Kb(a.a),i.Kb(a.c),i.Kb(c.a))},e.\u0275cmp=i.Eb({type:e,selectors:[["app-admin-edit"]],decls:4,vars:3,consts:[[1,"text-center"],["class","spinner-border","role","status",4,"ngIf"],[3,"type","close",4,"ngIf"],[3,"ngSubmit",4,"ngIf"],["role","status",1,"spinner-border"],[1,"sr-only"],[3,"type","close"],[3,"ngSubmit"],["UserEditForm","ngForm"],[1,"form-group"],[2,"margin","3px"],[4,"ngIf"],["for","name"],["type","text","id","name","placeholder","example","name","username","required","",1,"form-control","mb-1",3,"ngModel"],["for","email"],["type","email","id","email","placeholder","exampe@example.com","name","useremail","required","","email","",1,"form-control","mb-1",3,"ngModel"],["for","phone"],["type","tel","id","phone","placeholder","+7 (965) 777-77-77","name","userphone","pattern","^((8|\\+7)[\\- ]?)?(\\(?\\d{3,4}\\)?[\\- ]?)?[\\d\\- ]{5,10}$",1,"form-control","mb-1",3,"ngModel"],["for","roles"],["name","roles","id","roles","required","",1,"form-control",3,"ngModel"],["value","guest_role_read_only"],["value","admin_role_CRUD"],["for","newpassword"],[1,"input-group","mb-3"],[1,"input-group-prepend"],[1,"input-group-text"],["type","checkbox","id","changepassword","name","changepassword",3,"ngModel","ngModelChange"],["type","password","id","newpassword","name","newpassword","placeholder","Enter new password","ngModel","",1,"form-control",3,"disabled"],["type","submit",1,"btn","btn-outline-primary",3,"disabled"],["type","button","routerLink","..",1,"btn","btn-outline-danger",2,"margin-left","3px"]],template:function(e,t){1&e&&(i.Pb(0,"div",0),i.uc(1,x,3,0,"div",1),i.Ob(),i.uc(2,y,2,2,"ngb-alert",2),i.uc(3,C,37,9,"form",3)),2&e&&(i.xb(1),i.fc("ngIf",t.IsLoading),i.xb(1),i.fc("ngIf",t.ShowMessage),i.xb(1),i.fc("ngIf",t.UserToEdit))},directives:[s.k,b.a,O.r,O.i,O.j,O.b,O.o,O.h,O.k,O.c,O.n,O.p,O.l,O.q,O.a,a.d],styles:["input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#ff0a1d!important;box-shadow:none!important}input.ng-invalid.ng-touched[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem rgba(255,10,29,.25)!important}input.ng-valid.ng-touched[_ngcontent-%COMP%]{border-color:#67c07b!important;box-shadow:none!important}input.ng-valid.ng-touched[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem rgba(52,179,13,.25)!important}select.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#ff0a1d!important;box-shadow:none!important}select.ng-invalid.ng-touched[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem rgba(255,10,29,.25)!important}select.ng-valid.ng-touched[_ngcontent-%COMP%]{border-color:#67c07b!important;box-shadow:none!important}select.ng-valid.ng-touched[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem rgba(52,179,13,.25)!important}.image-placeholder[_ngcontent-%COMP%]{background-color:#eee;display:flex;height:333px;margin:5px;border-radius:3px;max-width:592px}.image-placeholder[_ngcontent-%COMP%] > h4[_ngcontent-%COMP%]{align-self:center;text-align:center;width:100%}"]}),e})();var L=n("lJxs");const I=[{path:"",redirectTo:"1",pathMatch:"full"},{path:":pn",component:w,canActivate:[P.a],data:{expectedRole:"admin_role_CRUD"}},{path:":pn/new",component:E},{path:":pn/:id",component:E,resolve:[(()=>{class e{constructor(e){this.datastorageservice=e}resolve(e,t){const n=e.params.id;return this.datastorageservice.FetchUsersList(e.params.pn,o.a.AdminUserListPageSize).pipe(Object(L.a)(e=>e.Users[n]))}}return e.\u0275fac=function(t){return new(t||e)(i.Xb(c.a))},e.\u0275prov=i.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()]}];let k=(()=>{class e{}return e.\u0275mod=i.Ib({type:e}),e.\u0275inj=i.Hb({factory:function(t){return new(t||e)},imports:[[s.b,O.d,b.b,b.j,a.g.forChild(I)]]}),e})()}}]);