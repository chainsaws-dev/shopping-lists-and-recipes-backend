"use strict";(self.webpackChunkshopping_lists_and_recipes=self.webpackChunkshopping_lists_and_recipes||[]).push([[649],{162:(_,D,o)=>{o.d(D,{P:()=>d});class d{constructor(p,h,r,x,e,g){this.Filename=p,this.Filesize=h,this.Filetype=r,this.FileID=x,this.ID=g,this.PreviewID=e}}},2245:(_,D,o)=>{o.d(D,{y:()=>h});var d=o(162),c=o(7579),S=o(2340),p=o(5e3);let h=(()=>{class r{constructor(){this.FileSelected=new c.x,this.FilesUpdated=new c.x,this.FilesInserted=new c.x,this.FilesDeleted=new c.x,this.FilesChanged=new c.x,this.Files=[]}GetFiles(){return this.Files.slice()}SetFiles(e){this.Files=e,this.FilesUpdated.next()}SetPagination(e,g,a){this.Total=e}SelectItemFilesList(e){this.CurrentSelectedItem=e,this.FileSelected.next(e)}IsCurrentSelected(e){return this.CurrentSelectedItem===e}GetFileById(e){return e<this.Files.length&&e>0?this.Files[e]:this.Files[0]}UpdateExistingFile(e,g){this.Files[g]=e,this.FilesChanged.next(e)}AddNewFile(e){const g=new d.P(e.Filename,e.Filesize,e.Filetype,e.FileID,e.PreviewID,e.ID);this.Files.length<S.N.AdminUserListPageSize&&this.Files.push(g),this.FilesChanged.next(g),this.FilesInserted.next()}DeleteFile(e){this.Files.splice(e,1),this.FilesDeleted.next()}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=p.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},9101:(_,D,o)=>{o.d(D,{j:()=>S});var d=o(7579),c=o(5e3);let S=(()=>{class p{constructor(){this.SessionsUpdated=new d.x,this.SessionsInserted=new d.x,this.SessionsDeleted=new d.x,this.SessionsChanged=new d.x,this.SessionsSelected=new d.x,this.Sessions=[]}GetSessions(){return this.Sessions.slice()}SetSessions(r){this.Sessions=r,this.SessionsUpdated.next()}SetPagination(r,x,e){this.Total=r}SelectItemSessionsList(r){this.CurrentSelectedItem=r,this.SessionsSelected.next(r)}IsCurrentSelected(r){return this.CurrentSelectedItem===r}GetSessionById(r){return r<this.Sessions.length&&r>0?this.Sessions[r]:this.Sessions[0]}DeleteSession(r){this.Sessions.splice(r,1),this.SessionsDeleted.next()}}return p.\u0275fac=function(r){return new(r||p)},p.\u0275prov=c.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()},1203:(_,D,o)=>{o.d(D,{n:()=>d});class d{constructor(p,h,r,x){this.GUID="",this.Role=p,this.Email=h,this.Phone=r,this.Name=x,this.IsAdmin=!1,this.Confirmed=!1,this.SecondFactor=!1,this.Disabled=!1}}},9112:(_,D,o)=>{o.d(D,{f:()=>h});var d=o(1203),c=o(7579),S=o(2340),p=o(5e3);let h=(()=>{class r{constructor(){this.UserSelected=new c.x,this.UsersUpdated=new c.x,this.UsersInserted=new c.x,this.UsersDeleted=new c.x,this.UsersChanged=new c.x,this.Users=[]}GetUsers(){return this.Users.slice()}SetUsers(e){this.Users=e,this.UsersUpdated.next()}SetPagination(e,g,a){this.Total=e}SelectItemUsersList(e){this.CurrentSelectedItem=e,this.UserSelected.next(e)}IsCurrentSelected(e){return this.CurrentSelectedItem===e}GetUserById(e){return e<this.Users.length&&e>0?this.Users[e]:this.Users[0]}UpdateExistingUser(e,g){this.Users[g]=e,this.UsersChanged.next(e)}AddNewUser(e){const g=new d.n(e.Role,e.Email,e.Phone,e.Name);this.Users.length<S.N.AdminUserListPageSize&&this.Users.push(g),this.UsersChanged.next(g),this.UsersInserted.next()}DeleteUser(e){this.Users.splice(e,1),this.UsersDeleted.next()}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=p.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},3671:(_,D,o)=>{o.d(D,{p:()=>d});class d{constructor(p,h,r,x,e,g){this.Name=p,this.Description=h,this.ImagePath=r,this.Ingredients=x,this.ImageDbID=e,this.ID=g}}},5496:(_,D,o)=>{o.d(D,{j:()=>x});var d=o(3671),c=o(3481),S=o(7579),p=o(2340),h=o(5e3),r=o(2457);let x=(()=>{class e{constructor(a){this.ShopList=a,this.IngredientSelected=new S.x,this.RecipeChanged=new S.x,this.RecipesUpdated=new S.x,this.RecipesInserted=new S.x,this.RecipesDeleted=new S.x,this.recipes=[]}GetRecipes(){return this.recipes.slice(0,p.N.RecipePageSize)}GetRecipesLen(){return this.recipes.length}GetRecipeById(a){return a<this.recipes.length&&a>0?this.recipes[a]:this.recipes[0]}GetRecipeId(a){return this.recipes.indexOf(a)}SendToShoppingList(a){a.forEach(u=>{this.ShopList.AddNewItem(u,!0)})}GetShoppingList(){return this.ShopList.GetIngredients()}AddNewRecipe(a){const u=new d.p(a.Name,a.Description,a.ImagePath,a.Ingredients,a.ImageDbID,a.ID);this.recipes.length<p.N.RecipePageSize&&this.recipes.push(u),this.RecipeChanged.next(u),this.RecipesInserted.next()}UpdateExistingRecipe(a,u){this.recipes[u]=a,this.RecipeChanged.next(a)}SetRecipes(a){this.recipes=a,this.RecipesUpdated.next()}DeleteRecipe(a){this.recipes.splice(a,1),this.RecipesDeleted.next()}AddNewIngredient(a){const u=this.RecipeToEdit.Ingredients.find(E=>E.Name===a.Name);u?u.Amount=u.Amount+a.Amount:this.RecipeToEdit.Ingredients.push(new c.o7(a.Name,a.Amount))}UpdateSelectedIngredient(a){const u=this.RecipeToEdit.Ingredients.find(E=>E.Name===a.Name);if(u&&u!==this.CurrentSelectedItem)u.Name=a.Name,u.Amount=u.Amount+a.Amount,this.DeleteSelectedIngredient();else{const E=this.RecipeToEdit.Ingredients.find(m=>m===this.CurrentSelectedItem);E&&(E.Name=a.Name,E.Amount=a.Amount)}this.CurrentSelectedItem=null,this.IngredientSelected.next(this.CurrentSelectedItem)}DeleteSelectedIngredient(){const a=this.RecipeToEdit.Ingredients.indexOf(this.CurrentSelectedItem);-1!==a&&this.RecipeToEdit.Ingredients.splice(a,1),this.CurrentSelectedItem=null}ClearAllIngredients(){this.RecipeToEdit.Ingredients=[],this.CurrentSelectedItem=null}GetIngredientsLength(){return this.RecipeToEdit.Ingredients.length}IngredientSelect(a){this.CurrentSelectedItem=a,this.IngredientSelected.next(a)}}return e.\u0275fac=function(a){return new(a||e)(h.LFG(r._))},e.\u0275prov=h.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},3649:(_,D,o)=>{o.d(D,{Z:()=>m});var d=o(520),c=o(3481),S=o(4004),p=o(8505),h=o(2340),r=o(7579),x=o(5e3),e=o(5496),g=o(2457),a=o(9112),u=o(2245),E=o(9101);let m=(()=>{class L{constructor(i,n,s,t,l,I){this.http=i,this.recipes=n,this.shoppinglist=s,this.users=t,this.media=l,this.sessions=I,this.LoadingData=new r.x,this.RecipesUpdateInsert=new r.x,this.RecivedError=new r.x,this.PaginationSet=new r.x,this.FileUploadProgress=new r.x,this.FileUploaded=new r.x,this.UserUpdateInsert=new r.x,this.CurrentUserFetch=new r.x,this.TwoFactorSub=new r.x}FetchRecipes(i,n){this.LoadingData.next(!0);const s={headers:new d.WM({Page:i.toString(),Limit:n.toString()})};return this.http.get(h.N.GetSetRecipesUrl,s).pipe((0,S.U)(t=>(t.Recipes=t.Recipes.map(l=>Object.assign(Object.assign({},l),{Ingredients:l.Ingredients?l.Ingredients:[]})),t)),(0,p.b)(t=>{this.recipes.SetRecipes(t.Recipes),this.PaginationSet.next(new c.tl(t.Total,t.Limit,t.Offset)),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)}))}SearchRecipes(i,n,s){this.LoadingData.next(!0);const t={headers:new d.WM({Page:i.toString(),Limit:n.toString(),Search:s})};return this.http.get(h.N.SearchRecipesUrl,t).pipe((0,S.U)(l=>(l.Recipes=l.Recipes.map(I=>Object.assign(Object.assign({},I),{Ingredients:I.Ingredients?I.Ingredients:[]})),l)),(0,p.b)(l=>{this.recipes.SetRecipes(l.Recipes),this.PaginationSet.next(new c.tl(l.Total,l.Limit,l.Offset)),this.LoadingData.next(!1)},l=>{this.RecivedError.next(l.error),this.LoadingData.next(!1)}))}SaveRecipe(i){this.LoadingData.next(!0),this.http.post(h.N.GetSetRecipesUrl,i).subscribe(n=>{this.RecipesUpdateInsert.next(n),this.RecivedError.next(new c.iQ(200,"\u0414\u0430\u043d\u043d\u044b\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b")),this.LoadingData.next(!1)},n=>{this.RecivedError.next(n.error),this.LoadingData.next(!1)})}FetchFilesList(i,n){this.LoadingData.next(!0);const s={headers:new d.WM({Page:i.toString(),Limit:n.toString()})};return this.http.get(h.N.GetSetFileUrl,s).pipe((0,p.b)(t=>{this.media.SetFiles(t.Files),this.media.SetPagination(t.Total,t.Limit,t.Offset),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)}))}FileUpload(i){const n=new FormData;n.append("file",i,i.name),this.http.post(h.N.GetSetFileUrl,n,{headers:new d.WM({}),reportProgress:!0,observe:"events"}).subscribe(s=>{s.type===d.dt.UploadProgress?this.FileUploadProgress.next(String(s.loaded/s.total*100)):s.type===d.dt.Response&&s.ok&&this.FileUploaded.next(s.body)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}DeleteFile(i,n){this.LoadingData.next(!0);const s={headers:new d.WM({FileID:i.toString()})};this.http.delete(h.N.GetSetFileUrl,s).subscribe(t=>{n||this.RecivedError.next(t),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)})}DeleteRecipe(i){this.LoadingData.next(!0);const n={headers:new d.WM({RecipeID:i.ID.toString()})};this.http.delete(h.N.GetSetRecipesUrl,n).subscribe(s=>{this.RecivedError.next(s),this.LoadingData.next(!1),this.DeleteFile(i.ImageDbID,!0)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}FetchShoppingList(i,n){this.LoadingData.next(!0);const s={headers:new d.WM({Page:i.toString(),Limit:n.toString()})};return this.http.get(h.N.GetSetShoppingListUrl,s).pipe((0,p.b)(t=>{this.shoppinglist.SetIngredients(t.Items),this.shoppinglist.SetPagination(t.Total,t.Limit,t.Offset),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)}))}SaveShoppingList(i){this.LoadingData.next(!0),this.http.post(h.N.GetSetShoppingListUrl,i).subscribe(n=>{this.RecipesUpdateInsert.next(n),this.RecivedError.next(new c.iQ(200,"\u0414\u0430\u043d\u043d\u044b\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b")),this.LoadingData.next(!1)},n=>{this.RecivedError.next(n.error),this.LoadingData.next(!1)})}DeleteShoppingList(i){this.LoadingData.next(!0);const n={headers:new d.WM({IngName:encodeURI(i.Name)})};this.http.delete(h.N.GetSetShoppingListUrl,n).subscribe(s=>{this.RecivedError.next(s),this.LoadingData.next(!1)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}DeleteAllShoppingList(){this.http.delete(h.N.GetSetShoppingListUrl).subscribe(i=>{this.RecivedError.next(i),this.LoadingData.next(!1)},i=>{this.RecivedError.next(i.error),this.LoadingData.next(!1)})}FetchSessionsList(i,n){this.LoadingData.next(!0);const s={headers:new d.WM({Page:i.toString(),Limit:n.toString()})};return this.http.get(h.N.GetSetSessionsUrl,s).pipe((0,p.b)(t=>{this.sessions.SetSessions(t.Sessions),this.sessions.SetPagination(t.Total,t.Limit,t.Offset),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)}))}DeleteSessionByToken(i){this.LoadingData.next(!0);const n={headers:new d.WM({Token:i})};this.http.delete(h.N.GetSetSessionsUrl,n).subscribe(s=>{this.RecivedError.next(s),this.LoadingData.next(!1)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}DeleteSessionByEmail(i){this.LoadingData.next(!0);const n={headers:new d.WM({Email:i})};this.http.delete(h.N.GetSetSessionsUrl,n).subscribe(s=>{this.RecivedError.next(s),this.LoadingData.next(!1)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}FetchUsersList(i,n){this.LoadingData.next(!0);const s={headers:new d.WM({Page:i.toString(),Limit:n.toString()})};return this.http.get(h.N.GetSetUsersUrl,s).pipe((0,p.b)(t=>{this.users.SetUsers(t.Users),this.users.SetPagination(t.Total,t.Limit,t.Offset),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)}))}FetchCurrentUser(){return this.LoadingData.next(!0),this.http.get(h.N.GetSetCurrentUserUrl).subscribe(i=>{this.CurrentUserFetch.next(i),this.LoadingData.next(!1)},i=>{this.RecivedError.next(i.error),this.LoadingData.next(!1)})}SaveCurrentUser(i,n,s){this.LoadingData.next(!0),0===i.GUID.length&&(i.GUID="00000000-0000-0000-0000-000000000000"),this.GetObsForSaveCurrentUser(i,n,s).subscribe(t=>{this.UserUpdateInsert.next(t),this.RecivedError.next(new c.iQ(200,"\u0414\u0430\u043d\u043d\u044b\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b")),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)})}SaveUser(i,n,s){this.LoadingData.next(!0),0===i.GUID.length&&(i.GUID="00000000-0000-0000-0000-000000000000"),this.GetObsForSaveUser(i,n,s).subscribe(t=>{this.UserUpdateInsert.next(t),this.RecivedError.next(new c.iQ(200,"\u0414\u0430\u043d\u043d\u044b\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b")),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)})}LinkTwoFactor(i,n){const s={headers:new d.WM({Passcode:i})};this.http.post(h.N.TOTPSettingsUrl,n,s).subscribe(t=>{n.SecondFactor=!0,this.TwoFactorSub.next(n),this.RecivedError.next(t),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)})}UnlinkTwoFactor(i){this.http.delete(h.N.TOTPSettingsUrl).subscribe(n=>{i.SecondFactor=!1,this.TwoFactorSub.next(i),this.RecivedError.next(n),this.LoadingData.next(!1)},n=>{this.RecivedError.next(n.error),this.LoadingData.next(!1)})}GetObsForSaveCurrentUser(i,n,s){if(n){const t={headers:new d.WM({NewPassword:encodeURI(s)})};return this.http.post(h.N.GetSetCurrentUserUrl,i,t)}return this.http.post(h.N.GetSetCurrentUserUrl,i)}GetObsForSaveUser(i,n,s){if(n){const t={headers:new d.WM({NewPassword:encodeURI(s)})};return this.http.post(h.N.GetSetUsersUrl,i,t)}return this.http.post(h.N.GetSetUsersUrl,i)}DeleteUser(i){this.LoadingData.next(!0);const n={headers:new d.WM({UserID:encodeURI(i.GUID)})};this.http.delete(h.N.GetSetUsersUrl,n).subscribe(s=>{this.RecivedError.next(s),this.LoadingData.next(!1)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}ConfirmEmail(i){this.LoadingData.next(!0);const n={headers:new d.WM({Token:i})};this.http.post(h.N.ConfirmEmailUrl,null,n).subscribe(s=>{this.RecivedError.next(s),this.LoadingData.next(!1)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}SendEmailConfirmEmail(i){this.LoadingData.next(!0);const n={headers:new d.WM({Email:i})};this.http.post(h.N.ResendEmailUrl,null,n).subscribe(s=>{this.RecivedError.next(s),this.LoadingData.next(!1)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}SendEmailResetPassword(i){this.LoadingData.next(!0);const n={headers:new d.WM({Email:i})};this.http.post(h.N.SendEmailResetPassUrl,null,n).subscribe(s=>{this.RecivedError.next(s),this.LoadingData.next(!1)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}SubmitNewPassword(i,n){this.LoadingData.next(!0);const s={headers:new d.WM({Token:i,NewPassword:encodeURI(n)})};this.http.post(h.N.ResetPasswordUrl,null,s).subscribe(t=>{this.RecivedError.next(t),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)})}}return L.\u0275fac=function(i){return new(i||L)(x.LFG(d.eN),x.LFG(e.j),x.LFG(g._),x.LFG(a.f),x.LFG(u.y),x.LFG(E.j))},L.\u0275prov=x.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})()},3481:(_,D,o)=>{o.d(D,{iQ:()=>S,o7:()=>d,tl:()=>h});class d{constructor(x,e){this.Name=x,this.Amount=e}}class S{constructor(x,e){this.Error=new p(x,e)}}class p{constructor(x,e){this.Code=x,this.Message=e}}class h{constructor(x,e,g){this.Total=x,this.Limit=e,this.Offset=g}}},2457:(_,D,o)=>{o.d(D,{_:()=>h});var d=o(3481),c=o(7579),S=o(2340),p=o(5e3);let h=(()=>{class r{constructor(){this.IngredientSelected=new c.x,this.IngredientChanged=new c.x,this.IngredientsUpdated=new c.x,this.IngredientAdded=new c.x,this.IngredientUpdated=new c.x,this.IngredientDeleted=new c.x,this.IngredientClear=new c.x,this.ingredients=[]}GetIngredients(){return this.ingredients.slice()}GetIngredientsLength(){return this.ingredients.length}SetIngredients(e){this.ingredients=e,this.IngredientsUpdated.next()}SetPagination(e,g,a){this.Total=e}AddNewItem(e,g){let a=this.ingredients.find(u=>u.Name===e.Name);a?a.Amount=a.Amount+e.Amount:(a=e,(this.ingredients.length<S.N.ShoppingListPageSize||g)&&this.ingredients.push(new d.o7(e.Name,e.Amount))),this.IngredientAdded.next(a),this.IngredientChanged.next(this.ingredients.slice())}UpdateSelectedItem(e){let g=this.ingredients.find(a=>a.Name===e.Name);if(g&&g!==this.CurrentSelectedItem)g.Name=e.Name,g.Amount=g.Amount+e.Amount,this.DeleteSelectedItem();else{const a=this.ingredients.indexOf(this.CurrentSelectedItem);-1!==a&&(this.ingredients[a]=e,this.IngredientChanged.next(this.ingredients.slice())),g=this.CurrentSelectedItem}this.IngredientUpdated.next(g),this.CurrentSelectedItem=null}DeleteSelectedItem(){const e=this.ingredients.indexOf(this.CurrentSelectedItem);-1!==e&&this.ingredients.splice(e,1),this.IngredientDeleted.next(this.CurrentSelectedItem),this.IngredientChanged.next(this.ingredients.slice()),this.CurrentSelectedItem=null}ClearAll(){this.ingredients=[],this.CurrentSelectedItem=null,this.IngredientChanged.next(this.ingredients.slice()),this.SetPagination(0,0,0),this.IngredientClear.next()}SelectItemShopList(e){this.CurrentSelectedItem=e,this.IngredientSelected.next(e)}IsCurrentSelected(e){return this.CurrentSelectedItem===e}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=p.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()}}]);