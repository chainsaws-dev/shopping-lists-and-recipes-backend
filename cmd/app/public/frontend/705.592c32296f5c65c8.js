"use strict";(self.webpackChunkshopping_lists_and_recipes=self.webpackChunkshopping_lists_and_recipes||[]).push([[705],{162:(D,S,o)=>{o.d(S,{P:()=>d});class d{constructor(p,h,r,u,e,g){this.Filename=p,this.Filesize=h,this.Filetype=r,this.FileID=u,this.ID=g,this.PreviewID=e}}},2245:(D,S,o)=>{o.d(S,{y:()=>h});var d=o(162),l=o(8023),x=o(2340),p=o(9724);let h=(()=>{class r{constructor(){this.FileSelected=new l.x,this.FilesUpdated=new l.x,this.FilesInserted=new l.x,this.FilesDeleted=new l.x,this.FilesChanged=new l.x,this.Files=[]}GetFiles(){return this.Files.slice()}SetFiles(e){this.Files=e,this.FilesUpdated.next()}SetPagination(e,g,a){this.Total=e}SelectItemFilesList(e){this.CurrentSelectedItem=e,this.FileSelected.next(e)}IsCurrentSelected(e){return this.CurrentSelectedItem===e}GetFileById(e){return e<this.Files.length&&e>0?this.Files[e]:this.Files[0]}UpdateExistingFile(e,g){this.Files[g]=e,this.FilesChanged.next(e)}AddNewFile(e){const g=new d.P(e.Filename,e.Filesize,e.Filetype,e.FileID,e.PreviewID,e.ID);this.Files.length<x.N.AdminUserListPageSize&&this.Files.push(g),this.FilesChanged.next(g),this.FilesInserted.next()}DeleteFile(e){this.Files.splice(e,1),this.FilesDeleted.next()}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=p.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},9101:(D,S,o)=>{o.d(S,{j:()=>x});var d=o(8023),l=o(9724);let x=(()=>{class p{constructor(){this.SessionsUpdated=new d.x,this.SessionsInserted=new d.x,this.SessionsDeleted=new d.x,this.SessionsChanged=new d.x,this.SessionsSelected=new d.x,this.Sessions=[]}GetSessions(){return this.Sessions.slice()}SetSessions(r){this.Sessions=r,this.SessionsUpdated.next()}SetPagination(r,u,e){this.Total=r}SelectItemSessionsList(r){this.CurrentSelectedItem=r,this.SessionsSelected.next(r)}IsCurrentSelected(r){return this.CurrentSelectedItem===r}GetSessionById(r){return r<this.Sessions.length&&r>0?this.Sessions[r]:this.Sessions[0]}DeleteSession(r){this.Sessions.splice(r,1),this.SessionsDeleted.next()}}return p.\u0275fac=function(r){return new(r||p)},p.\u0275prov=l.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()},1203:(D,S,o)=>{o.d(S,{n:()=>d});class d{constructor(p,h,r,u,e){this.GUID="",this.Role=p,this.Email=h,this.Phone=r,this.Name=u,this.Lang=e,this.IsAdmin=!1,this.Confirmed=!1,this.SecondFactor=!1,this.Disabled=!1}}},9112:(D,S,o)=>{o.d(S,{f:()=>h});var d=o(1203),l=o(8023),x=o(2340),p=o(9724);let h=(()=>{class r{constructor(){this.UserSelected=new l.x,this.UsersUpdated=new l.x,this.UsersInserted=new l.x,this.UsersDeleted=new l.x,this.UsersChanged=new l.x,this.Users=[]}GetUsers(){return this.Users.slice()}SetUsers(e){this.Users=e,this.UsersUpdated.next()}SetPagination(e,g,a){this.Total=e}SelectItemUsersList(e){this.CurrentSelectedItem=e,this.UserSelected.next(e)}IsCurrentSelected(e){return this.CurrentSelectedItem===e}GetUserById(e){return e<this.Users.length&&e>0?this.Users[e]:this.Users[0]}UpdateExistingUser(e,g){this.Users[g]=e,this.UsersChanged.next(e)}AddNewUser(e){const g=new d.n(e.Role,e.Email,e.Phone,e.Name,e.Lang);this.Users.length<x.N.AdminUserListPageSize&&this.Users.push(g),this.UsersChanged.next(g),this.UsersInserted.next()}DeleteUser(e){this.Users.splice(e,1),this.UsersDeleted.next()}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=p.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},3671:(D,S,o)=>{o.d(S,{p:()=>d});class d{constructor(p,h,r,u,e,g){this.Name=p,this.Description=h,this.ImagePath=r,this.Ingredients=u,this.ImageDbID=e,this.ID=g}}},5496:(D,S,o)=>{o.d(S,{j:()=>u});var d=o(3671),l=o(3481),x=o(8023),p=o(2340),h=o(9724),r=o(2457);let u=(()=>{class e{constructor(a){this.ShopList=a,this.IngredientSelected=new x.x,this.RecipeChanged=new x.x,this.RecipesUpdated=new x.x,this.RecipesInserted=new x.x,this.RecipesDeleted=new x.x,this.recipes=[]}GetRecipes(){return this.recipes.slice(0,p.N.RecipePageSize)}GetRecipesLen(){return this.recipes.length}GetRecipeById(a){return a<this.recipes.length&&a>0?this.recipes[a]:this.recipes[0]}GetRecipeId(a){return this.recipes.indexOf(a)}SendToShoppingList(a){a.forEach(_=>{this.ShopList.AddNewItem(_,!0)})}GetShoppingList(){return this.ShopList.GetIngredients()}AddNewRecipe(a){const _=new d.p(a.Name,a.Description,a.ImagePath,a.Ingredients,a.ImageDbID,a.ID);this.recipes.length<p.N.RecipePageSize&&this.recipes.push(_),this.RecipeChanged.next(_),this.RecipesInserted.next()}UpdateExistingRecipe(a,_){this.recipes[_]=a,this.RecipeChanged.next(a)}SetRecipes(a){this.recipes=a,this.RecipesUpdated.next()}DeleteRecipe(a){this.recipes.splice(a,1),this.RecipesDeleted.next()}AddNewIngredient(a){const _=this.RecipeToEdit.Ingredients.find(E=>E.Name===a.Name);_?_.Amount=_.Amount+a.Amount:this.RecipeToEdit.Ingredients.push(new l.o7(a.Name,a.Amount))}UpdateSelectedIngredient(a){const _=this.RecipeToEdit.Ingredients.find(E=>E.Name===a.Name);if(_&&_!==this.CurrentSelectedItem)_.Name=a.Name,_.Amount=_.Amount+a.Amount,this.DeleteSelectedIngredient();else{const E=this.RecipeToEdit.Ingredients.find(m=>m===this.CurrentSelectedItem);E&&(E.Name=a.Name,E.Amount=a.Amount)}this.CurrentSelectedItem=null,this.IngredientSelected.next(this.CurrentSelectedItem)}DeleteSelectedIngredient(){const a=this.RecipeToEdit.Ingredients.indexOf(this.CurrentSelectedItem);-1!==a&&this.RecipeToEdit.Ingredients.splice(a,1),this.CurrentSelectedItem=null}ClearAllIngredients(){this.RecipeToEdit.Ingredients=[],this.CurrentSelectedItem=null}GetIngredientsLength(){return this.RecipeToEdit.Ingredients.length}IngredientSelect(a){this.CurrentSelectedItem=a,this.IngredientSelected.next(a)}}return e.\u0275fac=function(a){return new(a||e)(h.LFG(r._))},e.\u0275prov=h.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},3649:(D,S,o)=>{o.d(S,{Z:()=>m});var d=o(9725),l=o(3481),x=o(7969),p=o(8168),h=o(2340),r=o(8023),u=o(9724),e=o(5496),g=o(2457),a=o(9112),_=o(2245),E=o(9101);let m=(()=>{class I{constructor(i,n,s,t,c,L){this.http=i,this.recipes=n,this.shoppinglist=s,this.users=t,this.media=c,this.sessions=L,this.LoadingData=new r.x,this.RecipesUpdateInsert=new r.x,this.RecivedError=new r.x,this.PaginationSet=new r.x,this.FileUploadProgress=new r.x,this.FileUploaded=new r.x,this.UserUpdateInsert=new r.x,this.CurrentUserFetch=new r.x,this.TwoFactorSub=new r.x}FetchRecipes(i,n){this.LoadingData.next(!0);const s={headers:new d.WM({Page:i.toString(),Limit:n.toString()})};return this.http.get(h.N.GetSetRecipesUrl,s).pipe((0,x.U)(t=>(t.Recipes=t.Recipes.map(c=>Object.assign(Object.assign({},c),{Ingredients:c.Ingredients?c.Ingredients:[]})),t)),(0,p.b)(t=>{this.recipes.SetRecipes(t.Recipes),this.PaginationSet.next(new l.tl(t.Total,t.Limit,t.Offset)),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)}))}SearchRecipes(i,n,s){this.LoadingData.next(!0);const t={headers:new d.WM({Page:i.toString(),Limit:n.toString(),Search:s})};return this.http.get(h.N.SearchRecipesUrl,t).pipe((0,x.U)(c=>(c.Recipes=c.Recipes.map(L=>Object.assign(Object.assign({},L),{Ingredients:L.Ingredients?L.Ingredients:[]})),c)),(0,p.b)(c=>{this.recipes.SetRecipes(c.Recipes),this.PaginationSet.next(new l.tl(c.Total,c.Limit,c.Offset)),this.LoadingData.next(!1)},c=>{this.RecivedError.next(c.error),this.LoadingData.next(!1)}))}SaveRecipe(i){this.LoadingData.next(!0),this.http.post(h.N.GetSetRecipesUrl,i).subscribe(n=>{this.RecipesUpdateInsert.next(n),this.RecivedError.next(new l.iQ(200,"\u0414\u0430\u043d\u043d\u044b\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b")),this.LoadingData.next(!1)},n=>{this.RecivedError.next(n.error),this.LoadingData.next(!1)})}FetchFilesList(i,n){this.LoadingData.next(!0);const s={headers:new d.WM({Page:i.toString(),Limit:n.toString()})};return this.http.get(h.N.GetSetFileUrl,s).pipe((0,p.b)(t=>{this.media.SetFiles(t.Files),this.media.SetPagination(t.Total,t.Limit,t.Offset),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)}))}FileUpload(i){const n=new FormData;n.append("file",i,i.name),this.http.post(h.N.GetSetFileUrl,n,{headers:new d.WM({}),reportProgress:!0,observe:"events"}).subscribe(s=>{s.type===d.dt.UploadProgress?this.FileUploadProgress.next(String(s.loaded/s.total*100)):s.type===d.dt.Response&&s.ok&&this.FileUploaded.next(s.body)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}DeleteFile(i,n){this.LoadingData.next(!0);const s={headers:new d.WM({FileID:i.toString()})};this.http.delete(h.N.GetSetFileUrl,s).subscribe(t=>{n||this.RecivedError.next(t),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)})}DeleteRecipe(i){this.LoadingData.next(!0);const n={headers:new d.WM({RecipeID:i.ID.toString()})};this.http.delete(h.N.GetSetRecipesUrl,n).subscribe(s=>{this.RecivedError.next(s),this.LoadingData.next(!1),this.DeleteFile(i.ImageDbID,!0)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}FetchShoppingList(i,n){this.LoadingData.next(!0);const s={headers:new d.WM({Page:i.toString(),Limit:n.toString()})};return this.http.get(h.N.GetSetShoppingListUrl,s).pipe((0,p.b)(t=>{this.shoppinglist.SetIngredients(t.Items),this.shoppinglist.SetPagination(t.Total,t.Limit,t.Offset),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)}))}SaveShoppingList(i){this.LoadingData.next(!0),this.http.post(h.N.GetSetShoppingListUrl,i).subscribe(n=>{this.RecipesUpdateInsert.next(n),this.RecivedError.next(new l.iQ(200,"\u0414\u0430\u043d\u043d\u044b\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b")),this.LoadingData.next(!1)},n=>{this.RecivedError.next(n.error),this.LoadingData.next(!1)})}DeleteShoppingList(i){this.LoadingData.next(!0);const n={headers:new d.WM({IngName:encodeURI(i.Name)})};this.http.delete(h.N.GetSetShoppingListUrl,n).subscribe(s=>{this.RecivedError.next(s),this.LoadingData.next(!1)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}DeleteAllShoppingList(){this.http.delete(h.N.GetSetShoppingListUrl).subscribe(i=>{this.RecivedError.next(i),this.LoadingData.next(!1)},i=>{this.RecivedError.next(i.error),this.LoadingData.next(!1)})}FetchSessionsList(i,n){this.LoadingData.next(!0);const s={headers:new d.WM({Page:i.toString(),Limit:n.toString()})};return this.http.get(h.N.GetSetSessionsUrl,s).pipe((0,p.b)(t=>{this.sessions.SetSessions(t.Sessions),this.sessions.SetPagination(t.Total,t.Limit,t.Offset),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)}))}DeleteSessionByToken(i){this.LoadingData.next(!0);const n={headers:new d.WM({Token:i})};this.http.delete(h.N.GetSetSessionsUrl,n).subscribe(s=>{this.RecivedError.next(s),this.LoadingData.next(!1)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}DeleteSessionByEmail(i){this.LoadingData.next(!0);const n={headers:new d.WM({Email:i})};this.http.delete(h.N.GetSetSessionsUrl,n).subscribe(s=>{this.RecivedError.next(s),this.LoadingData.next(!1)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}FetchUsersList(i,n){this.LoadingData.next(!0);const s={headers:new d.WM({Page:i.toString(),Limit:n.toString()})};return this.http.get(h.N.GetSetUsersUrl,s).pipe((0,p.b)(t=>{this.users.SetUsers(t.Users),this.users.SetPagination(t.Total,t.Limit,t.Offset),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)}))}FetchCurrentUser(){return this.LoadingData.next(!0),this.http.get(h.N.GetSetCurrentUserUrl).subscribe(i=>{this.CurrentUserFetch.next(i),this.LoadingData.next(!1)},i=>{this.RecivedError.next(i.error),this.LoadingData.next(!1)})}SaveCurrentUser(i,n,s){this.LoadingData.next(!0),0===i.GUID.length&&(i.GUID="00000000-0000-0000-0000-000000000000"),this.GetObsForSaveCurrentUser(i,n,s).subscribe({next:t=>{this.UserUpdateInsert.next(t),this.RecivedError.next(new l.iQ(200,"\u0414\u0430\u043d\u043d\u044b\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b")),this.LoadingData.next(!1)},error:t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)}})}SaveUser(i,n,s){this.LoadingData.next(!0),0===i.GUID.length&&(i.GUID="00000000-0000-0000-0000-000000000000"),this.GetObsForSaveUser(i,n,s).subscribe(t=>{this.UserUpdateInsert.next(t),this.RecivedError.next(new l.iQ(200,"\u0414\u0430\u043d\u043d\u044b\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b")),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)})}LinkTwoFactor(i,n){const s={headers:new d.WM({Passcode:i})};this.http.post(h.N.TOTPSettingsUrl,n,s).subscribe(t=>{n.SecondFactor=!0,this.TwoFactorSub.next(n),this.RecivedError.next(t),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)})}UnlinkTwoFactor(i){this.http.delete(h.N.TOTPSettingsUrl).subscribe(n=>{i.SecondFactor=!1,this.TwoFactorSub.next(i),this.RecivedError.next(n),this.LoadingData.next(!1)},n=>{this.RecivedError.next(n.error),this.LoadingData.next(!1)})}GetObsForSaveCurrentUser(i,n,s){if(n){const t={headers:new d.WM({NewPassword:encodeURI(s)})};return this.http.post(h.N.GetSetCurrentUserUrl,i,t)}return this.http.post(h.N.GetSetCurrentUserUrl,i)}GetObsForSaveUser(i,n,s){if(n){const t={headers:new d.WM({NewPassword:encodeURI(s)})};return this.http.post(h.N.GetSetUsersUrl,i,t)}return this.http.post(h.N.GetSetUsersUrl,i)}DeleteUser(i){this.LoadingData.next(!0);const n={headers:new d.WM({UserID:encodeURI(i.GUID)})};this.http.delete(h.N.GetSetUsersUrl,n).subscribe(s=>{this.RecivedError.next(s),this.LoadingData.next(!1)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}ConfirmEmail(i){this.LoadingData.next(!0);const n={headers:new d.WM({Token:i})};this.http.post(h.N.ConfirmEmailUrl,null,n).subscribe(s=>{this.RecivedError.next(s),this.LoadingData.next(!1)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}SendEmailConfirmEmail(i){this.LoadingData.next(!0);const n={headers:new d.WM({Email:i})};this.http.post(h.N.ResendEmailUrl,null,n).subscribe(s=>{this.RecivedError.next(s),this.LoadingData.next(!1)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}SendEmailResetPassword(i){this.LoadingData.next(!0);const n={headers:new d.WM({Email:i})};this.http.post(h.N.SendEmailResetPassUrl,null,n).subscribe(s=>{this.RecivedError.next(s),this.LoadingData.next(!1)},s=>{this.RecivedError.next(s.error),this.LoadingData.next(!1)})}SubmitNewPassword(i,n){this.LoadingData.next(!0);const s={headers:new d.WM({Token:i,NewPassword:encodeURI(n)})};this.http.post(h.N.ResetPasswordUrl,null,s).subscribe(t=>{this.RecivedError.next(t),this.LoadingData.next(!1)},t=>{this.RecivedError.next(t.error),this.LoadingData.next(!1)})}}return I.\u0275fac=function(i){return new(i||I)(u.LFG(d.eN),u.LFG(e.j),u.LFG(g._),u.LFG(a.f),u.LFG(_.y),u.LFG(E.j))},I.\u0275prov=u.Yz7({token:I,factory:I.\u0275fac,providedIn:"root"}),I})()},8177:(D,S,o)=>{o.d(S,{J:()=>l});var d=o(9724);let l=(()=>{class x{transform(h){return h.substring(0,1).toUpperCase()+h.substring(1)}}return x.\u0275fac=function(h){return new(h||x)},x.\u0275pipe=d.Yjl({name:"FirstLetterUpperPipe",type:x,pure:!0}),x})()},3481:(D,S,o)=>{o.d(S,{iQ:()=>x,o7:()=>d,tl:()=>h});class d{constructor(u,e){this.Name=u,this.Amount=e}}class x{constructor(u,e){this.Error=new p(u,e)}}class p{constructor(u,e){this.Code=u,this.Message=e}}class h{constructor(u,e,g){this.Total=u,this.Limit=e,this.Offset=g}}},2457:(D,S,o)=>{o.d(S,{_:()=>h});var d=o(3481),l=o(8023),x=o(2340),p=o(9724);let h=(()=>{class r{constructor(){this.IngredientSelected=new l.x,this.IngredientChanged=new l.x,this.IngredientsUpdated=new l.x,this.IngredientAdded=new l.x,this.IngredientUpdated=new l.x,this.IngredientDeleted=new l.x,this.IngredientClear=new l.x,this.ingredients=[]}GetIngredients(){return this.ingredients.slice()}GetIngredientsLength(){return this.ingredients.length}SetIngredients(e){this.ingredients=e,this.IngredientsUpdated.next()}SetPagination(e,g,a){this.Total=e}AddNewItem(e,g){let a=this.ingredients.find(_=>_.Name===e.Name);a?a.Amount=a.Amount+e.Amount:(a=e,(this.ingredients.length<x.N.ShoppingListPageSize||g)&&this.ingredients.push(new d.o7(e.Name,e.Amount))),this.IngredientAdded.next(a),this.IngredientChanged.next(this.ingredients.slice())}UpdateSelectedItem(e){let g=this.ingredients.find(a=>a.Name===e.Name);if(g&&g!==this.CurrentSelectedItem)g.Name=e.Name,g.Amount=g.Amount+e.Amount,this.DeleteSelectedItem();else{const a=this.ingredients.indexOf(this.CurrentSelectedItem);-1!==a&&(this.ingredients[a]=e,this.IngredientChanged.next(this.ingredients.slice())),g=this.CurrentSelectedItem}this.IngredientUpdated.next(g),this.CurrentSelectedItem=null}DeleteSelectedItem(){const e=this.ingredients.indexOf(this.CurrentSelectedItem);-1!==e&&this.ingredients.splice(e,1),this.IngredientDeleted.next(this.CurrentSelectedItem),this.IngredientChanged.next(this.ingredients.slice()),this.CurrentSelectedItem=null}ClearAll(){this.ingredients=[],this.CurrentSelectedItem=null,this.IngredientChanged.next(this.ingredients.slice()),this.SetPagination(0,0,0),this.IngredientClear.next()}SelectItemShopList(e){this.CurrentSelectedItem=e,this.IngredientSelected.next(e)}IsCurrentSelected(e){return this.CurrentSelectedItem===e}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=p.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()}}]);